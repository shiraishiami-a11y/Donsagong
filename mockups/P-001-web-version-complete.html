<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Golden Peppa - 四柱推命</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: #f5f5f7;
            color: #1d1d1f;
            line-height: 1.6;
            padding: 20px;
        }

        /* コンテナ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* ヘッダー */
        .header {
            background: #D4AF37;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(212, 175, 55, 0.3);
        }

        .header h1 {
            font-size: 36px;
            font-weight: 700;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            letter-spacing: 2px;
        }

        .user-info {
            margin-top: 10px;
            font-size: 16px;
            color: rgba(255,255,255,0.9);
        }

        /* メインレイアウト */
        .main-layout {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 30px;
        }

        /* 左パネル - 入力フォーム */
        .left-panel {
            background: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            border: 1px solid #e5e5e7;
        }

        .form-section-title {
            font-size: 20px;
            font-weight: 600;
            color: #D4AF37;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(212, 175, 55, 0.3);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #1d1d1f;
            font-size: 14px;
            font-weight: 500;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            background: #ffffff;
            border: 1px solid #d2d2d7;
            border-radius: 8px;
            color: #1d1d1f;
            font-size: 15px;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #D4AF37;
            background: #fffef5;
        }

        .gender-options {
            display: flex;
            gap: 15px;
        }

        .gender-option {
            flex: 1;
        }

        .gender-option input[type="radio"] {
            display: none;
        }

        .gender-option label {
            display: block;
            padding: 12px;
            background: #f5f5f7;
            border: 1px solid #d2d2d7;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .gender-option input[type="radio"]:checked + label {
            background: rgba(212, 175, 55, 0.2);
            border-color: #D4AF37;
            color: #D4AF37;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #D4AF37, #F4E04B);
            color: #ffffff;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.4);
        }

        /* 右パネル - 結果表示 */
        .right-panel {
            background: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            border: 1px solid #e5e5e7;
        }

        /* 大運数表示 */
        .daeunsu-display {
            background: rgba(212, 175, 55, 0.1);
            border: 2px solid #D4AF37;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 10px;
            text-align: center;
        }

        .daeunsu-label {
            font-size: 14px;
            color: #86868b;
            margin-bottom: 5px;
        }

        .daeunsu-value {
            font-size: 28px;
            font-weight: 700;
            color: #D4AF37;
            text-shadow: 0 2px 10px rgba(212, 175, 55, 0.3);
        }

        /* 四柱表 */
        .saju-table-wrapper {
            margin-bottom: 30px;
        }

        .result-section-title {
            font-size: 24px;
            font-weight: 600;
            color: #D4AF37;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .result-section-title::before {
            content: "◆";
            color: #D4AF37;
        }

        .saju-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .saju-pillar {
            background: #f5f5f7;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .saju-pillar:hover {
            transform: translateY(-5px);
        }

        .pillar-label {
            padding: 10px;
            text-align: center;
            font-size: 14px;
            font-weight: 600;
            color: #1d1d1f;
            background: rgba(212, 175, 55, 0.15);
        }

        /* 年柱 - 赤系 */
        .year-pillar .stem {
            background: #E74C3C;
            color: #fff;
        }
        .year-pillar .branch {
            background: #C0392B;
            color: #fff;
        }

        /* 月柱 - オレンジ系 */
        .month-pillar .stem {
            background: #F39C12;
            color: #fff;
        }
        .month-pillar .branch {
            background: #D68910;
            color: #fff;
        }

        /* 日柱 - 緑系 */
        .day-pillar .stem {
            background: #27AE60;
            color: #fff;
        }
        .day-pillar .branch {
            background: #229954;
            color: #fff;
        }

        /* 時柱 - 紫系 */
        .time-pillar .stem {
            background: #8E44AD;
            color: #fff;
        }
        .time-pillar .branch {
            background: #7D3C98;
            color: #fff;
        }

        .stem, .branch {
            padding: 25px 10px;
            font-size: 28px;
            font-weight: 700;
            text-align: center;
        }

        .element-info {
            padding: 8px;
            text-align: center;
            font-size: 12px;
            color: #86868b;
            background: #f5f5f7;
        }

        /* 運勢階層表示 */
        .fortune-hierarchy {
            margin-bottom: 30px;
        }

        .fortune-level {
            background: #f5f5f7;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 10px;
            border-left: 4px solid #D4AF37;
        }

        .fortune-level-title {
            font-size: 18px;
            font-weight: 600;
            color: #D4AF37;
            margin-bottom: 15px;
        }

        .fortune-items {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .fortune-item {
            background: #ffffff;
            padding: 10px 20px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            border: 1px solid #d2d2d7;
            transition: all 0.3s ease;
        }

        .fortune-item:hover {
            transform: translateY(-2px);
            border-color: #D4AF37;
        }

        .fortune-item.active {
            background: rgba(212, 175, 55, 0.2);
            border-color: #D4AF37;
        }

        .fortune-badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            color: white;
        }

        /* 運勢レベル */
        .level-excellent { background: linear-gradient(135deg, #ff3b30, #ff6b6b); }
        .level-good { background: linear-gradient(135deg, #ff9500, #ffb347); }
        .level-normal { background: linear-gradient(135deg, #ffcc00, #ffe066); }
        .level-bad { background: linear-gradient(135deg, #34c759, #52d976); }
        .level-terrible { background: linear-gradient(135deg, #5856d6, #7c7aff); }

        /* 人生グラフ */
        .life-graph-section {
            background: #f5f5f7;
            padding: 25px;
            border-radius: 10px;
        }

        #lifeChart {
            width: 100%;
            height: 250px;
            background: #ffffff;
            border-radius: 8px;
            margin-top: 15px;
            border: 1px solid #d2d2d7;
        }

        /* 初期メッセージ */
        .initial-message {
            text-align: center;
            padding: 100px 20px;
            color: #86868b;
        }

        .initial-message h2 {
            font-size: 32px;
            color: #D4AF37;
            margin-bottom: 15px;
        }

        .initial-message p {
            font-size: 16px;
        }

        /* ローディング */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-content {
            text-align: center;
        }

        .loading-spinner {
            width: 80px;
            height: 80px;
            border: 4px solid #333;
            border-top: 4px solid #D4AF37;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 18px;
            color: #D4AF37;
        }

        /* レスポンシブ */
        @media (max-width: 1024px) {
            .main-layout {
                grid-template-columns: 1fr;
            }

            .saju-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 640px) {
            .saju-grid {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 24px;
            }

            body {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ヘッダー -->
        <div class="header">
            <h1>Golden Peppa 四柱推命</h1>
            <div class="user-info">
                あなたの運命を詳しく占います
            </div>
        </div>

        <!-- メインレイアウト -->
        <div class="main-layout">
            <!-- 左パネル - 入力フォーム -->
            <div class="left-panel">
                <h2 class="form-section-title">基本情報</h2>
                <form id="fortuneForm">
                    <div class="form-group">
                        <label for="name">お名前</label>
                        <input type="text" id="name" name="name" placeholder="山田太郎" required>
                    </div>

                    <div class="form-group">
                        <label>性別</label>
                        <div class="gender-options">
                            <div class="gender-option">
                                <input type="radio" id="male" name="gender" value="male" checked>
                                <label for="male">男性</label>
                            </div>
                            <div class="gender-option">
                                <input type="radio" id="female" name="gender" value="female">
                                <label for="female">女性</label>
                            </div>
                        </div>
                    </div>

                    <h2 class="form-section-title">生年月日・時刻</h2>

                    <div class="form-group">
                        <label for="year">生年</label>
                        <input type="number" id="year" name="year" placeholder="1990" min="1900" max="2024" required>
                    </div>

                    <div class="form-group">
                        <label for="month">生月</label>
                        <select id="month" name="month" required>
                            <option value="">選択してください</option>
                            <option value="1">1月</option>
                            <option value="2">2月</option>
                            <option value="3">3月</option>
                            <option value="4">4月</option>
                            <option value="5">5月</option>
                            <option value="6">6月</option>
                            <option value="7">7月</option>
                            <option value="8">8月</option>
                            <option value="9">9月</option>
                            <option value="10">10月</option>
                            <option value="11">11月</option>
                            <option value="12">12月</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="day">生日</label>
                        <input type="number" id="day" name="day" placeholder="15" min="1" max="31" required>
                    </div>

                    <div class="form-group">
                        <label for="hour">生時</label>
                        <select id="hour" name="hour" required>
                            <option value="">選択してください</option>
                            <option value="子">子時 (23:00-01:00)</option>
                            <option value="丑">丑時 (01:00-03:00)</option>
                            <option value="寅">寅時 (03:00-05:00)</option>
                            <option value="卯">卯時 (05:00-07:00)</option>
                            <option value="辰">辰時 (07:00-09:00)</option>
                            <option value="巳">巳時 (09:00-11:00)</option>
                            <option value="午">午時 (11:00-13:00)</option>
                            <option value="未">未時 (13:00-15:00)</option>
                            <option value="申">申時 (15:00-17:00)</option>
                            <option value="酉">酉時 (17:00-19:00)</option>
                            <option value="戌">戌時 (19:00-21:00)</option>
                            <option value="亥">亥時 (21:00-23:00)</option>
                        </select>
                    </div>

                    <button type="submit" class="submit-btn">運命を占う</button>
                </form>
            </div>

            <!-- 右パネル - 結果表示 -->
            <div class="right-panel">
                <!-- 初期メッセージ -->
                <div class="initial-message" id="initialMessage">
                    <h2>四柱推命へようこそ</h2>
                    <p>左のフォームに生年月日情報を入力して、あなたの運命を解き明かしましょう。</p>
                </div>

                <!-- 結果表示エリア -->
                <div id="resultContent" style="display: none;">
                    <!-- 大運数表示 -->
                    <div class="daeunsu-display">
                        <div class="daeunsu-label">大運数</div>
                        <div class="daeunsu-value" id="daeunsuValue">5歳・順行</div>
                    </div>

                    <!-- 四柱表 -->
                    <div class="saju-table-wrapper">
                        <h3 class="result-section-title">四柱推命盤</h3>
                        <div class="saju-grid">
                            <!-- 年柱 -->
                            <div class="saju-pillar year-pillar">
                                <div class="pillar-label">年柱</div>
                                <div class="stem" id="yearStem">庚</div>
                                <div class="branch" id="yearBranch">午</div>
                                <div class="element-info">金・火</div>
                            </div>

                            <!-- 月柱 -->
                            <div class="saju-pillar month-pillar">
                                <div class="pillar-label">月柱</div>
                                <div class="stem" id="monthStem">乙</div>
                                <div class="branch" id="monthBranch">子</div>
                                <div class="element-info">木・水</div>
                            </div>

                            <!-- 日柱 -->
                            <div class="saju-pillar day-pillar">
                                <div class="pillar-label">日柱</div>
                                <div class="stem" id="dayStem">庚</div>
                                <div class="branch" id="dayBranch">寅</div>
                                <div class="element-info">金・木</div>
                            </div>

                            <!-- 時柱 -->
                            <div class="saju-pillar time-pillar">
                                <div class="pillar-label">時柱</div>
                                <div class="stem" id="timeStem">甲</div>
                                <div class="branch" id="timeBranch">子</div>
                                <div class="element-info">木・水</div>
                            </div>
                        </div>
                    </div>

                    <!-- 運勢階層表示 -->
                    <div class="fortune-hierarchy">
                        <h3 class="result-section-title">運勢分析</h3>

                        <!-- 大運 -->
                        <div class="fortune-level">
                            <div class="fortune-level-title">大運（10年運）</div>
                            <div class="fortune-items">
                                <div class="fortune-item">
                                    <span>2020-2029</span>
                                    <span class="fortune-badge level-good">吉</span>
                                </div>
                                <div class="fortune-item active">
                                    <span>2030-2039</span>
                                    <span class="fortune-badge level-excellent">大吉</span>
                                </div>
                                <div class="fortune-item">
                                    <span>2040-2049</span>
                                    <span class="fortune-badge level-normal">普通</span>
                                </div>
                            </div>
                        </div>

                        <!-- 年運 -->
                        <div class="fortune-level">
                            <div class="fortune-level-title">年運（年間運）</div>
                            <div class="fortune-items">
                                <div class="fortune-item">
                                    <span>2024年</span>
                                    <span class="fortune-badge level-good">吉</span>
                                </div>
                                <div class="fortune-item active">
                                    <span>2025年</span>
                                    <span class="fortune-badge level-excellent">大吉</span>
                                </div>
                                <div class="fortune-item">
                                    <span>2026年</span>
                                    <span class="fortune-badge level-normal">普通</span>
                                </div>
                            </div>
                        </div>

                        <!-- 月運 -->
                        <div class="fortune-level">
                            <div class="fortune-level-title">月運（月間運）</div>
                            <div class="fortune-items">
                                <div class="fortune-item">
                                    <span>8月</span>
                                    <span class="fortune-badge level-normal">普通</span>
                                </div>
                                <div class="fortune-item active">
                                    <span>9月</span>
                                    <span class="fortune-badge level-good">吉</span>
                                </div>
                                <div class="fortune-item">
                                    <span>10月</span>
                                    <span class="fortune-badge level-bad">凶</span>
                                </div>
                            </div>
                        </div>

                        <!-- 日運 -->
                        <div class="fortune-level">
                            <div class="fortune-level-title">日運（日間運）</div>
                            <div class="fortune-items">
                                <div class="fortune-item active">
                                    <span>今日</span>
                                    <span class="fortune-badge level-excellent">大吉</span>
                                </div>
                                <div class="fortune-item">
                                    <span>明日</span>
                                    <span class="fortune-badge level-good">吉</span>
                                </div>
                                <div class="fortune-item">
                                    <span>明後日</span>
                                    <span class="fortune-badge level-terrible">大凶</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 人生グラフ -->
                    <div class="life-graph-section">
                        <h3 class="result-section-title">人生運勢グラフ</h3>
                        <canvas id="lifeChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ローディングオーバーレイ -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">運命を解析中...</div>
        </div>
    </div>

    <script>
        // 天干と地支の定義
        const heavenlyStems = ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'];
        const earthlyBranches = ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'];

        // 蔵干データ
        const hiddenStems = {
            '子': '癸',
            '丑': '己癸辛',
            '寅': '甲丙戊',
            '卯': '乙',
            '辰': '戊乙癸',
            '巳': '丙庚戊',
            '午': '丁己',
            '未': '己丁乙',
            '申': '庚壬戊',
            '酉': '辛',
            '戌': '戊辛丁',
            '亥': '壬甲'
        };

        // フォーム送信処理
        document.getElementById('fortuneForm').addEventListener('submit', function(e) {
            e.preventDefault();

            // ローディング表示
            document.getElementById('loadingOverlay').classList.add('active');

            // 2秒後に結果表示
            setTimeout(() => {
                calculateAndDisplayFortune();
                document.getElementById('loadingOverlay').classList.remove('active');
            }, 2000);
        });

        // 四柱推命計算と表示
        function calculateAndDisplayFortune() {
            const year = parseInt(document.getElementById('year').value);
            const month = parseInt(document.getElementById('month').value);
            const day = parseInt(document.getElementById('day').value);
            const hourBranch = document.getElementById('hour').value;

            // 簡易的な四柱計算（実際の計算はより複雑）
            const yearIndex = (year - 4) % 60;
            const yearStemIndex = yearIndex % 10;
            const yearBranchIndex = yearIndex % 12;

            // 月柱の計算
            const monthStemIndex = ((year % 5) * 2 + Math.floor((month + 1) / 2)) % 10;
            const monthBranchIndex = (month + 1) % 12;

            // 日柱の計算（簡略化）
            const dayStemIndex = (year * 5 + Math.floor(year / 4) + month * 2 + day) % 10;
            const dayBranchIndex = (year * 5 + Math.floor(year / 4) + month * 2 + day) % 12;

            // 時柱の設定
            const timeBranchIndex = earthlyBranches.indexOf(hourBranch);
            const timeStemIndex = (dayStemIndex * 2 + Math.floor(timeBranchIndex / 2)) % 10;

            // 四柱の表示更新
            document.getElementById('yearStem').textContent = heavenlyStems[yearStemIndex];
            document.getElementById('yearBranch').textContent = earthlyBranches[yearBranchIndex];

            document.getElementById('monthStem').textContent = heavenlyStems[monthStemIndex];
            document.getElementById('monthBranch').textContent = earthlyBranches[monthBranchIndex];

            document.getElementById('dayStem').textContent = heavenlyStems[dayStemIndex];
            document.getElementById('dayBranch').textContent = earthlyBranches[dayBranchIndex];

            document.getElementById('timeStem').textContent = heavenlyStems[timeStemIndex];
            document.getElementById('timeBranch').textContent = hourBranch;

            // 大運数の計算
            const gender = document.querySelector('input[name="gender"]:checked').value;
            const isForward = (gender === 'male' && yearStemIndex % 2 === 0) ||
                             (gender === 'female' && yearStemIndex % 2 === 1);
            const daeunsuAge = 3 + Math.floor(Math.random() * 5); // 簡略化: 3-7歳の間
            document.getElementById('daeunsuValue').textContent = `${daeunsuAge}歳・${isForward ? '順行' : '逆行'}`;

            // 結果表示
            document.getElementById('initialMessage').style.display = 'none';
            document.getElementById('resultContent').style.display = 'block';

            // グラフ描画
            drawLifeChart();
        }

        // 人生運勢グラフ描画
        function drawLifeChart() {
            const canvas = document.getElementById('lifeChart');
            const ctx = canvas.getContext('2d');

            // キャンバスサイズ設定
            canvas.width = canvas.offsetWidth;
            canvas.height = 250;

            // グラフデータ（大運に合わせた運勢）
            const ages = [];
            const fortunes = [];
            for (let i = 0; i <= 90; i += 5) {
                ages.push(i);
                // 大運期間ごとに運勢を変化
                if (i < 15) fortunes.push(60 + Math.random() * 20);
                else if (i < 25) fortunes.push(70 + Math.random() * 20);
                else if (i < 35) fortunes.push(80 + Math.random() * 15);
                else if (i < 45) fortunes.push(85 + Math.random() * 10);
                else if (i < 55) fortunes.push(70 + Math.random() * 20);
                else if (i < 65) fortunes.push(60 + Math.random() * 25);
                else fortunes.push(50 + Math.random() * 30);
            }

            // グラフ描画
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // グリッド線
            ctx.strokeStyle = 'rgba(0,0,0,0.1)';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 5; i++) {
                const y = (canvas.height / 5) * i;
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }

            // 運勢曲線
            ctx.strokeStyle = '#D4AF37';
            ctx.lineWidth = 3;
            ctx.beginPath();

            const xStep = canvas.width / (ages.length - 1);
            const yScale = canvas.height / 120;

            for (let i = 0; i < ages.length; i++) {
                const x = i * xStep;
                const y = canvas.height - (fortunes[i] * yScale + 20);

                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }

            ctx.stroke();

            // ポイントマーカー
            for (let i = 0; i < ages.length; i++) {
                const x = i * xStep;
                const y = canvas.height - (fortunes[i] * yScale + 20);

                ctx.fillStyle = getFortuneColor(fortunes[i]);
                ctx.beginPath();
                ctx.arc(x, y, 5, 0, Math.PI * 2);
                ctx.fill();
            }

            // 年齢ラベル
            ctx.fillStyle = '#86868b';
            ctx.font = '12px sans-serif';
            ctx.textAlign = 'center';
            for (let i = 0; i < ages.length; i += 2) {
                const x = i * xStep;
                ctx.fillText(ages[i] + '歳', x, canvas.height - 5);
            }
        }

        // 運勢レベルに応じた色を返す
        function getFortuneColor(value) {
            if (value >= 80) return '#ff3b30'; // 大吉
            if (value >= 60) return '#ff9500'; // 吉
            if (value >= 40) return '#ffcc00'; // 普通
            if (value >= 20) return '#34c759'; // 凶
            return '#5856d6'; // 大凶
        }
    </script>
</body>
</html>