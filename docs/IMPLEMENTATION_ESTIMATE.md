# ゴールデン四柱推命アプリケーション - 実装工数見積書

**プロジェクト名**: Golden Peppa（ゴールデンペッパー）
**バージョン**: v1.0.0
**作成日**: 2025年11月10日
**対象期間**: 2025年11月1日 〜 2025年11月10日

---

## 📊 プロジェクト概要

### 成果物
既存の210年節気データベース（1900-2109年）と検証済み万年暦計算システムを統合し、ゴールドテーマの美しいUIで四柱推命・大運・年月日運を網羅的に分析し、7段階吉凶判定と折れ線グラフで視覚化する個人利用型四柱推命Webアプリケーション。

### 技術スタック
- **フロントエンド**: React 19 + TypeScript 5 + Vite 7 + MUI v7
- **バックエンド**: FastAPI 0.109 + Python 3.9 + SQLAlchemy 2.0
- **データベース**: PostgreSQL 15 (Neon)
- **デプロイ**: Vercel (Frontend) + GCP Cloud Run (Backend)
- **テスト**: Playwright v1.56.1

### 実装状況サマリー
- ✅ Phase 1完了（全6ページ実装）
- ✅ 全APIエンドポイント実装完了
- ✅ 認証システム完了（JWT + RefreshToken）
- ✅ E2Eテスト 100% Pass（53/53項目）
- ✅ 本番環境デプロイ完了

---

## 📋 実装機能一覧

### 1. フロントエンド実装（React 19 + TypeScript）

#### 1.1 コアページ実装（6ページ）

| # | ページ名 | 機能概要 | 工数（人日） |
|---|---------|---------|------------|
| 1 | **TopPage** | 命式記入（生年月日時入力、性別選択、時間不明対応） | 3.0 |
| 2 | **ListPage** | 命式一覧表示（検索、フィルタ、削除、空状態対応） | 2.5 |
| 3 | **SajuDetailPage** | 命式詳細表示（四柱、大運、年月日運、人生グラフ） | 5.0 |
| 4 | **LoginPage** | ログイン（メール + パスワード、自動ログイン） | 1.5 |
| 5 | **RegisterPage** | 新規登録（ゲストデータ移行、パスワード強度） | 2.0 |
| 6 | **SettingsPage** | 設定（アカウント情報、データ管理、エクスポート） | 2.0 |
| **小計** | - | **全6ページ** | **16.0** |

#### 1.2 コンポーネント実装

| # | コンポーネント | 機能概要 | 工数（人日） |
|---|--------------|---------|------------|
| 1 | **GoldenPeppaLoading** | ローディングアニメーション（ペッパーミル + キラキラ） | 1.0 |
| 2 | **BottomNavigation** | ボトムナビゲーション（アイコン、リンク、レスポンシブ） | 1.0 |
| 3 | **SajuCard** | 命式カード（四柱ミニ表示、削除ボタン、ホバーエフェクト） | 1.5 |
| 4 | **BasicInfoSection** | 基本情報セクション（名前、性別、生年月日時） | 0.5 |
| 5 | **PillarsSection** | 四柱表示セクション（五行カラー、1.5倍拡大） | 1.0 |
| 6 | **LifeGraphSection** | 人生グラフ（Recharts統合、7段階吉凶、モバイル最適化） | 3.0 |
| 7 | **DaeunScrollSection** | 大運表示（水平スクロール、開始年齢表記） | 2.0 |
| 8 | **YearFortuneScrollSection** | 年運表示（水平スクロール、現在年マーカー） | 1.5 |
| 9 | **MonthFortuneScrollSection** | 月運表示（水平スクロール、現在月マーカー） | 1.5 |
| 10 | **DayFortuneScrollSection** | 日運表示（水平スクロール、今日マーカー） | 1.5 |
| **小計** | - | **全10コンポーネント** | **14.5** |

#### 1.3 共通機能実装

| # | 機能 | 詳細 | 工数（人日） |
|---|------|------|------------|
| 1 | **デザインシステム** | cardStyles.ts統一、ゴールドテーマ、五行カラー | 1.5 |
| 2 | **認証コンテキスト** | JWT + RefreshToken、自動ログイン、セッション管理 | 2.0 |
| 3 | **API統合** | 全エンドポイント統合、エラーハンドリング | 2.5 |
| 4 | **型定義** | TypeScript型定義（SajuResponse, FortuneLevel等） | 1.0 |
| 5 | **ユーティリティ** | sajuHelpers（formatBirthDateTime, getFortuneColor等） | 1.0 |
| 6 | **レスポンシブ対応** | xs/sm/md/lg/xl ブレークポイント最適化（全ページ） | 3.0 |
| **小計** | - | **全6機能** | **11.0** |

**フロントエンド合計**: **41.5人日**

---

### 2. バックエンド実装（FastAPI + Python）

#### 2.1 APIエンドポイント実装

| # | エンドポイント | メソッド | 機能概要 | 工数（人日） |
|---|--------------|---------|---------|------------|
| 1 | `/api/saju/calculate` | POST | 命式計算（四柱、大運、年月日運） | 3.0 |
| 2 | `/api/saju/save` | POST | 命式保存（ログインモード） | 1.0 |
| 3 | `/api/saju/list` | GET | 命式一覧取得（ユーザー別） | 1.0 |
| 4 | `/api/saju/{id}` | GET | 命式詳細取得 | 0.5 |
| 5 | `/api/saju/{id}` | DELETE | 命式削除 | 0.5 |
| 6 | `/api/saju/{id}/daeun` | GET | 大運データ取得 | 1.5 |
| 7 | `/api/saju/{id}/year/{year}` | GET | 年運データ取得 | 1.5 |
| 8 | `/api/saju/{id}/month/{year}` | GET | 月運データ取得 | 1.5 |
| 9 | `/api/saju/{id}/day/{year}/{month}` | GET | 日運データ取得 | 1.5 |
| 10 | `/api/saju/export` | GET | データエクスポート（JSON） | 1.0 |
| 11 | `/api/saju/migrate` | POST | ゲストデータ移行 | 1.5 |
| 12 | `/api/auth/login` | POST | ログイン（JWT発行） | 1.5 |
| 13 | `/api/auth/register` | POST | 新規登録 | 1.5 |
| 14 | `/api/auth/refresh` | POST | Refresh Token更新 | 1.0 |
| **小計** | - | **全14エンドポイント** | **19.0** |

#### 2.2 コアロジック実装

| # | モジュール | 機能概要 | 工数（人日） |
|---|-----------|---------|------------|
| 1 | **saju_calculator.py** | 四柱推命計算（lunar-python統合、210年節気DB） | 4.0 |
| 2 | **fortune_analyzer.py** | ドンサゴン分析（天干地支マトリックス、調候用神） | 5.0 |
| 3 | **fortune_service.py** | 吉凶判定（7段階システム、日干基準） | 2.5 |
| 4 | **daeun_service.py** | 大運計算（10年周期、性別考慮） | 2.0 |
| 5 | **graph_service.py** | 人生グラフデータ生成（Recharts形式） | 2.0 |
| 6 | **data_loader.py** | 210年節気DB + マトリックスデータ読込 | 1.5 |
| **小計** | - | **全6モジュール** | **17.0** |

#### 2.3 データベース・認証

| # | 機能 | 詳細 | 工数（人日） |
|---|------|------|------------|
| 1 | **データモデル設計** | User, SajuCalculation, Session（SQLAlchemy） | 1.5 |
| 2 | **Alembicマイグレーション** | 初期マイグレーション、バージョン管理 | 1.0 |
| 3 | **JWT認証** | Access Token + Refresh Token、セキュリティ | 2.5 |
| 4 | **CORS設定** | 本番環境最適化、Vercel統合 | 0.5 |
| 5 | **エラーハンドリング** | 統一エラーレスポンス、バリデーション | 1.0 |
| **小計** | - | **全5機能** | **6.5** |

**バックエンド合計**: **42.5人日**

---

### 3. テスト実装（Playwright E2E）

| # | テストチェーン | 項目数 | 機能概要 | 工数（人日） |
|---|--------------|--------|---------|------------|
| 1 | **CHAIN-001** | 11項目 | 命式計算全体フロー（正常系、異常系、エッジケース） | 2.5 |
| 2 | **CHAIN-002** | 4項目 | 水平スクロール運勢表示（大運、年月日運） | 1.0 |
| 3 | **CHAIN-003** | 5項目 | インタラクティブ運勢選択（階層的クリック） | 1.5 |
| 4 | **CHAIN-004** | 5項目 | ゲスト→ログイン移行（データ移行、チェックボックス） | 2.0 |
| 5 | **CHAIN-005** | 7項目 | データ管理統合（一覧、削除、エクスポート） | 2.0 |
| 6 | **CHAIN-006** | 20項目 | スマホレスポンシブ対応（横スクロール、タップ領域） | 3.0 |
| 7 | **UI改善テスト** | 7項目 | 人生グラフ要件（階段式、5段階色分け、点なし） | 1.0 |
| **小計** | **53項目** | **全7チェーン** | **13.0** |

**テスト合計**: **13.0人日**

---

### 4. デザイン・UX実装

| # | 機能 | 詳細 | 工数（人日） |
|---|------|------|------------|
| 1 | **Golden Peppaブランディング** | ロゴ、コンセプト、Indie Flowerフォント | 1.0 |
| 2 | **ゴールドカラーパレット** | PRIMARY_GOLD, LIGHT_GOLD, DARK_GOLD, PALE_GOLD | 0.5 |
| 3 | **五行カラーシステム** | 木火土金水（緑赤黄グレー黒） | 0.5 |
| 4 | **7段階吉凶カラー** | 大吉〜大凶（ゴールド〜赤） | 0.5 |
| 5 | **ローディングアニメーション** | ペッパーミル + キラキラエフェクト | 1.5 |
| 6 | **カードデザインシステム** | cardStyles.ts統一、ホバーエフェクト | 1.0 |
| 7 | **モバイル最適化** | タップ領域48px、フォント14px以上、横スクロール | 2.0 |
| **小計** | - | **全7機能** | **7.0** |

**デザイン合計**: **7.0人日**

---

### 5. デプロイ・インフラ

| # | 作業 | 詳細 | 工数（人日） |
|---|------|------|------------|
| 1 | **Vercel設定** | フロントエンドデプロイ、環境変数、固定URL | 1.0 |
| 2 | **GCP Cloud Run設定** | バックエンドデプロイ、Dockerfile、環境変数 | 2.0 |
| 3 | **Neon PostgreSQL** | データベース作成、接続設定、本番環境 | 0.5 |
| 4 | **CORS最適化** | 本番環境CORS設定、セキュリティ | 0.5 |
| 5 | **デプロイテスト** | 本番環境E2Eテスト、ログイン機能検証 | 1.0 |
| **小計** | - | **全5作業** | **5.0** |

**デプロイ合計**: **5.0人日**

---

### 6. ドキュメント作成

| # | ドキュメント | 内容 | 工数（人日） |
|---|------------|------|------------|
| 1 | **CLAUDE.md** | プロジェクト設定、技術スタック、コーディング規約 | 0.5 |
| 2 | **requirements.md** | 要件定義書（全10章、403行） | 1.5 |
| 3 | **SCOPE_PROGRESS.md** | E2Eテスト進捗管理（全7チェーン、852行） | 1.0 |
| 4 | **implementation_plan.md** | 実装計画書（Phase別タスク管理） | 0.5 |
| 5 | **DESIGN_DOCUMENT.md** | デザイン仕様書（カラー、フォント、レイアウト） | 0.5 |
| 6 | **API仕様書** | エンドポイント一覧、リクエスト/レスポンス形式 | 1.0 |
| **小計** | - | **全6ドキュメント** | **5.0** |

**ドキュメント合計**: **5.0人日**

---

## 💰 総工数見積もり

| カテゴリ | 工数（人日） | 比率 |
|---------|------------|------|
| フロントエンド実装 | 41.5 | 35.5% |
| バックエンド実装 | 42.5 | 36.4% |
| テスト実装 | 13.0 | 11.1% |
| デザイン・UX | 7.0 | 6.0% |
| デプロイ・インフラ | 5.0 | 4.3% |
| ドキュメント作成 | 5.0 | 4.3% |
| プロジェクト管理 | 3.0 | 2.6% |
| **合計** | **117.0人日** | **100%** |

### 期間換算
- **1人で実装**: 約117日（約5.9ヶ月）
- **2人で実装**: 約59日（約3.0ヶ月）
- **実績**: 10日間（2025-11-01 〜 2025-11-10）

### 生産性
- **実装速度**: 11.7人日/日（非常に高速）
- **理由**: 既存資産活用（210年節気DB、Python計算コード）、AI支援開発

---

## 🎯 品質保証

### E2Eテスト結果（2025-11-10時点）
- **総テスト項目数**: 53項目
- **Pass**: 53項目（100%）
- **Fail**: 0項目（0%）
- **テスト実行時間**: 平均6.8秒/項目

### コード品質
- **TypeScript**: strictモード有効、型安全性100%
- **Python**: type hints必須、mypy検証済み
- **未使用変数/import**: 0件
- **console.log（本番）**: 0件

### セキュリティ
- ✅ XSS脆弱性対策（React自動エスケープ）
- ✅ SQLインジェクション対策（SQLAlchemy ORM）
- ✅ CORS設定（本番環境最適化）
- ✅ JWT認証（Access Token + Refresh Token）
- ✅ パスワードハッシュ化（bcrypt）

---

## 📈 実装範囲

### Phase 1（完了）✅
- ✅ 全6ページ実装
- ✅ 全14APIエンドポイント実装
- ✅ 認証システム（JWT + RefreshToken）
- ✅ 7段階吉凶判定システム
- ✅ 人生グラフ（Recharts統合）
- ✅ モバイルレスポンシブ対応
- ✅ E2Eテスト100% Pass
- ✅ 本番環境デプロイ

### Phase 2（予定）
- パスワードリセット機能
- メールアドレス変更機能
- Snackbarトースト通知
- ARIA属性の完全対応

### Phase 3（予定）
- 相性診断機能（2人の命式比較）
- 年運詳細分析
- 択日システム
- モバイルアプリ版（React Native）

---

## 🔗 関連リンク

### デプロイ環境
- **フロントエンド**: https://frontend-amis-projects-474dde3c.vercel.app
- **バックエンド**: https://golden-saju-api-235426778039.asia-northeast1.run.app
- **データベース**: Neon PostgreSQL（無料枠）

### ドキュメント
- 要件定義書: `docs/requirements.md`
- 進捗管理: `docs/SCOPE_PROGRESS.md`
- 実装計画: `docs/implementation_plan.md`
- デザイン仕様: `mockups/DESIGN_DOCUMENT.md`

---

**作成日**: 2025年11月10日
**作成者**: Golden Peppa開発チーム
**バージョン**: v1.0.0
**最終更新**: 2025年11月10日
