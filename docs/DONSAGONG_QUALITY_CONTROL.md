# 🛡️ 돈사공 품질 관리 시스템
> **순수성 보장 & 학습자료 추적 & 검증 체계**
> 
> AI 지식 혼용 0% 달성을 위한 통합 품질 관리

---

## 🚨 절대 금지사항 (Red Flags)

### **즉시 중단 신호 - 이런 단어 발견 시 작업 중지**

#### 전통 명리학 용어 ❌
```
정관, 편관, 정재, 편재, 정인, 편인, 식신, 상관, 비견, 겁재
```

#### 오행론 용어 ❌
```
목화토금수, 상생, 상극
목생화, 화생토, 토생금, 금생수, 수생목
금극목, 목극토, 토극수, 수극화, 화극금
```

#### 신강/신약론 ❌
```
신강, 신약, 일간의 강약, 일간이 강하다, 일간이 약하다
```

#### 잘못된 개념 ❌
```
용신이 부족한 것을 채우는 개념
전통적인 합충 해석
년주를 포함한 4주 분석
```

---

## ✅ 돈사공 검증 프로토콜

### **Phase 1: 학습자료 우선 원칙**

#### 작업 순서 (필수)
1. **학습자료 먼저 읽기** - 추측 금지
2. **학습자료에 없으면 추가 금지** - 빈칸 유지
3. **AI 추론/해석 금지** - 원문 그대로
4. **문구 그대로 사용** - 의역 금지

#### 학습자료 위치
```
/learning-materials/
├── 대운/      # 천간, 지지 매트릭스
├── 용신/      # 용신 시스템
└── 조후/      # 조후 시스템
```

### **Phase 2: 실시간 검증**

#### 자동 금지어 검출
```python
class DonsagongValidator:
    def __init__(self):
        self.forbidden_terms = {
            '십신론': ['정관', '편관', '정재', '편재', '정인', 
                      '편인', '식신', '상관', '비견', '겁재'],
            '오행론': ['목생화', '화생토', '토생금', '금생수', '수생목',
                      '금극목', '목극토', '토극수', '수극화', '화극금'],
            '신강약': ['신강', '신약', '일간의 강', '일간의 약']
        }
    
    def validate(self, text):
        """텍스트 검증 - 금지어 포함 시 False 반환"""
        for category, terms in self.forbidden_terms.items():
            for term in terms:
                if term in text:
                    print(f"❌ {category} 용어 '{term}' 감지!")
                    return False
        return True
```

---

## 📚 학습자료 인덱스 (빠른 참조)

### **천간 매트릭스 (일간 → 다른 천간)**
| 일간 | 파일명 | 페이지 |
|-----|--------|--------|
| 갑목(甲) | 대운.032.png | p.32 |
| 을목(乙) | 대운.034.png | p.34 |
| 병화(丙) | 대운.036.png | p.36 |
| 정화(丁) | 대운.038.png | p.38 |
| 무토(戊) | 대운.040.png | p.40 |
| 기토(己) | 대운.042.png | p.42 |
| 경금(庚) | 대운.044.png | p.44 |
| 신금(辛) | 대운.046.png | p.46 |
| 임수(壬) | 대운.048.png | p.48 |
| 계수(癸) | 대운.051.png | p.51 |

### **지지 매트릭스 (일지 → 대운지지)**
| 일지 | 파일명 | 페이지 |
|-----|--------|--------|
| 인목(寅) | 대운.072.png | p.72 |
| 묘목(卯) | 대운.074.png | p.74 |
| 진토(辰) | 대운.076.png | p.76 |
| 사화(巳) | 대운.077.png | p.77 |
| 오화(午) | 대운.078.png | p.78 |
| 미토(未) | 대운.080.png | p.80 |
| 신금(申) | 대운.082.png | p.82 |
| 유금(酉) | 대운.083.png | p.83 |
| 술토(戌) | 대운.085.png | p.85 |
| 해수(亥) | 대운.087.png | p.87 |
| 자수(子) | 대운.089.png | p.89 |
| 축토(丑) | 대운.091.png | p.91 |

### **핵심 참조**
| 내용 | 파일명 | 중요도 |
|-----|--------|--------|
| 조후용신 호흉표 | 대운.070.png | ⭐⭐⭐ |
| 지지 합충 관계 | 대운.060-063.png | ⭐⭐⭐ |
| 용신 매트릭스 | 용신.007-016.png | ⭐⭐⭐ |

---

## 📊 순수도 측정 시스템

### **오염도 점수 (100점 만점)**

| 점수 | 상태 | 조치 |
|------|------|------|
| 90-100 | 🟢 안전 | 그대로 사용 |
| 70-89 | 🟡 주의 | 재검증 필요 |
| 50-69 | 🟠 위험 | 부분 수정 |
| 0-49 | 🔴 오염 | 전면 재작성 |

### **점수 산정 기준**
- **학습자료 직접 인용**: 100점
- **학습자료 기반 정리**: 90점
- **일부 해석 포함**: 50점 ⚠️
- **AI 지식 혼용**: 0점 ❌

---

## 📝 작업 추적 시스템

### **데이터 입력 템플릿**
```markdown
## [날짜] 데이터 입력 기록

### 작업 정보
- 파일: [파일명]
- 섹션: [섹션명]
- 출처: [학습자료 경로]

### 입력 데이터
[실제 입력한 내용]

### 원본 대조
- 학습자료 내용: [원본 텍스트]
- 일치 여부: ✅/❌

### 검증 결과
- [ ] 금지어 스캔 통과
- [ ] 돈사공 원칙 준수
- [ ] 출처 명시 완료

작업자: _______
검증자: _______
```

---

## 🔍 검증 도구

### **Python 검증 스크립트**
```python
# donsagong_validator.py

import re
from datetime import datetime

class QualityController:
    def __init__(self):
        self.forbidden_patterns = [
            r'정관|편관|정재|편재|정인|편인|식신|상관|비견|겁재',
            r'목생화|화생토|토생금|금생수|수생목',
            r'금극목|목극토|토극수|수극화|화극금',
            r'신강|신약|일간.*강|일간.*약'
        ]
        
    def scan_file(self, filepath):
        """파일 전체 스캔"""
        with open(filepath, 'r', encoding='utf-8') as f:
            content = f.read()
            
        violations = []
        for pattern in self.forbidden_patterns:
            matches = re.findall(pattern, content)
            if matches:
                violations.extend(matches)
                
        return {
            'file': filepath,
            'violations': violations,
            'score': 100 if not violations else 0,
            'timestamp': datetime.now()
        }
    
    def generate_report(self, scan_result):
        """검증 보고서 생성"""
        if scan_result['score'] == 100:
            return f"✅ 파일 안전: {scan_result['file']}"
        else:
            return f"❌ 오염 발견: {scan_result['violations']}"
```

---

## ✅ 품질 체크리스트

### **작업 시작 전**
- [ ] 학습자료 인덱스 열기
- [ ] 검증 스크립트 실행 준비
- [ ] 백업 파일 생성
- [ ] 작업 로그 파일 생성

### **작업 중**
- [ ] 학습자료 먼저 확인
- [ ] 복사-붙여넣기 우선
- [ ] 한 문장마다 원본 대조
- [ ] 금지어 실시간 체크

### **작업 완료 후**
- [ ] 전체 금지어 스캔
- [ ] 학습자료 출처 명시
- [ ] 돈사공 원칙 준수 확인
- [ ] 동료 검증 요청

---

## 💡 핵심 암기사항

### **돈사공 3대 원칙**
1. **용신 = 무기** (방어용, 부족 보충 아님)
2. **일지지 합은 무조건 길** (유일한 예외)
3. **조후용신 80% : 원국 20%** (대운 4배 중요)

### **돈사공만의 특징**
- 합(合)은 기본 흉 (전통과 반대)
- 천간과 지지 완전 분리
- 3주 체계 (년주 없음)
- 월지지는 용신 불가

### **공통원국지지용신**
- **여름생(巳午未)**: 申子辰
- **봄/가을/겨울생**: 午戌未
- **대안**: 巳丑

---

## 🔴 긴급 복구 절차

### **오염 발견 시**
1. **즉시 작업 중단**
2. **오염 부분 격리** (backup/ 폴더)
3. **검증된 버전 복원**
4. **원인 분석 보고서**
5. **재발 방지 대책**

### **롤백 명령**
```bash
# 마지막 검증 버전으로 복원
git checkout last-verified-commit
cp backup/DONSAGONG_*.md docs/
python donsagong_validator.py --scan-all
```

---

## 📈 품질 지표 대시보드

### **현재 상태**
```
순수도: [██████████] 100%
검증률: [██████████] 100%
출처명시: [██████████] 100%
금지어: [          ] 0개
```

### **목표**
- 순수도 100% 유지
- 검증률 100% 유지
- 금지어 0개 유지
- 학습자료 100% 추적

---

## 🏆 인증 마크

```markdown
✅ 돈사공 순수 데이터
━━━━━━━━━━━━━━━━━━
순수도: 100%
검증일: 2025-01-XX
검증자: AI/User
━━━━━━━━━━━━━━━━━━
```

---

*통합 버전: 2025년 1월*
*돈사공 품질 관리 시스템 v2.0*