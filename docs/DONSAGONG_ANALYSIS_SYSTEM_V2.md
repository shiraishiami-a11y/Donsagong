# 📊 DONSAGONG 완전 분석 시스템 v2.0

> **체계적이고 정확한 사주 분석을 위한 표준 프로세스**

---

## 🎯 분석 순서 (절대 지켜야 할 단계)

### 📌 STEP 0: 기본 정보 확인
```
□ 생년월일시 정확히 확인
□ 성별 확인 (대운 순/역행 결정)
□ 출생시간 유무 확인
  - 시간 있음 → 전체 분석
  - 시간 없음 → 월주, 일주만 분석
```

### 📌 STEP 1: 만세력 계산

#### 🔴 필수 참조 데이터베이스
```
1. /src/manseryeok/calculator.py - 메인 만세력 계산기
2. /src/manseryeok/api_daeun_calculator.py - API 기반 대운 계산기
3. /docs/DONSAGONG_MASTER_DATABASE.md - 용신/조후 매트릭스
4. /docs/MANSERYEOK_GUIDE.md - 만세력 계산 가이드
```

```python
# 1-1. 사주 원국 계산
from datetime import datetime
from src.manseryeok.calculator import ManseryeokCalculator

birth_datetime = datetime(년, 월, 일, 시, 분, 초)
calculator = ManseryeokCalculator()
saju = calculator.calculate_saju(birth_datetime, 'male' or 'female')

# 1-2. 원국 출력
년주: {saju.year_stem}{saju.year_branch}
월주: {saju.month_stem}{saju.month_branch}
일주: {saju.day_stem}{saju.day_branch}
시주: {saju.hour_stem}{saju.hour_branch}
일간: {saju.day_stem}

# 1-3. 대운 계산
daeun_info = calculator.calculate_daeun_with_lunar(saju)
```

### 📌 STEP 2: 원국 분석

#### 2-1. 원국 구성 파악
```
천간 구성: [병, 경, 무, 임] 등
지지 구성: [인, 자, 술, 자] 등
일간: 무토
월지: 자수 (계절 판단)
```

#### 2-2. 용신 추출
```
✅ 추출 가능 위치:
- 월간: 경금
- 일지: 술토  
- 시간: 임수 (시간 아는 경우)
- 시지: 자수 (시간 아는 경우)

❌ 추출 불가:
- 년주 전체 (년간, 년지)
- 월지
```

#### 2-3. 원국 용신 확인
```
일간 + 계절 → 필요 용신 조회
DONSAGONG_MASTER_DATABASE.md에서 확인

예) 무토 겨울생 용신:
- 천간: 丁, 丙, 甲, 乙
- 지지: 午, 戌, 未

원국에 있는 용신 체크:
□ 술토 (일지) ✅ 용신!
```

### 📌 STEP 3: 조후 분석

#### 3-1. 월지 확인
```
월지: 子 → 12월생 (겨울)
```

#### 3-2. 조후 길흉표 조회
```
DONSAGONG_MASTER_DATABASE.md
子월생 조후길흉 확인
```

#### 3-3. 특수 일간 체크
```
□ 정화(丁), 신금(辛) → 일운/건강운만 특수 조후
□ 나머지 8간 → 모든 운에서 월지 조후
```

### 📌 STEP 4: 대운 분석

#### 4-1. 현재 대운 확인
```
현재 나이 계산 → 해당 대운 찾기
예) 39세 → 36-45세 대운
```

#### 4-2. 대운 천간 매트릭스
```
일간 vs 대운천간
DONSAGONG_MASTER_DATABASE.md 천간 100 매트릭스
```

#### 4-3. 대운 지지 분석
```
- 조후 길흉 확인
- 원국 지지와의 관계 (합충형파해)
- 용신 여부 확인
```

### 📌 STEP 5: 세운 분석 (년운/월운)

#### 5-1. 올해 년운
```
2025년 = 을사년
- 천간: 일간 vs 을목
- 지지: 월지 vs 사화 (조후)
```

#### 5-2. 이번달 월운
```
2025년 9월 = 을유월
- 천간: 일간 vs 을목
- 지지: 월지 vs 유금 (조후)
```

### 📌 STEP 6: 종합 판단

#### 6-1. 가중치 적용
```
1순위: 조후 (80%)
2순위: 용신 유무 (15%)
3순위: 매트릭스 길흉 (5%)
```

#### 6-2. 긍정/부정 요소 정리
```
긍정 요소:
- 대운 천간 길
- 용신 있음
- 조후 좋음

부정 요소:
- 합충 관계
- 조후 나쁨
- 대흉 매트릭스
```

#### 6-3. 최종 평가
```
종합 점수: XX/100
운세 등급: 상/중상/중/중하/하
주의 사항: 
조언:
```

---

## ⚠️ 자주 하는 실수

### ❌ 하지 말아야 할 것
1. 원국 계산 없이 바로 분석
2. 일간 확인 없이 용신 찾기
3. 월지 확인 없이 조후 판단
4. 년주에서 용신 추출
5. 순서 무시하고 뒤죽박죽 분석

### ✅ 반드시 해야 할 것
1. STEP 순서대로 진행
2. 각 단계 완료 확인 후 다음 진행
3. 용신 추출 위치 엄격히 준수
4. 조후 우선순위 지키기
5. 특수 일간 구분하기

---

## 📋 체크리스트 템플릿

```markdown
## 🎯 [이름] 사주 분석

### 📌 기본 정보
- 생년월일시: YYYY-MM-DD HH:MM
- 성별: 남/여
- 현재 나이: XX세

### 📌 원국
```
년주: OO(O O)
월주: OO(O O)  
일주: OO(O O)
시주: OO(O O)
```
- 일간: O
- 월지: O (계절)

### 📌 용신 분석
- 필요 용신: 천간[...], 지지[...]
- 원국 용신: 
  □ 월간: X
  □ 일지: O (용신!)
  □ 시간: X
  □ 시지: X

### 📌 조후 분석
- O월생 조후길흉
  - 봄: ...
  - 여름: ...
  - 가을: ...
  - 겨울: ...

### 📌 대운
- 현재 대운 (XX-XX세): OO
  - 천간 매트릭스: O
  - 지지 조후: O
  - 용신 여부: O

### 📌 세운
- 년운: OO년
  - 천간: O
  - 지지 조후: O
  
- 월운: OO월
  - 천간: O
  - 지지 조후: O

### 📌 종합 판단
- 긍정 요소: ...
- 부정 요소: ...
- 종합 평가: XX/100
- 조언: ...
```

---

## 🔥 빠른 참조

### 조후 우선순위
```
조후 나쁨 + 용신 있음 = 보통
조후 좋음 + 용신 없음 = 괜찮음  
조후 좋음 + 용신 있음 = 매우 좋음
조후 나쁨 + 용신 없음 = 주의
```

### 대운 판단 공식
```
대운 = 천간 매트릭스 + 지지 조후 + 용신 체크
      = 30% + 60% + 10%
```

### 월지별 계절
```
寅卯辰 = 봄 (2,3,4월)
巳午未 = 여름 (5,6,7월)
申酉戌 = 가을 (8,9,10월)
亥子丑 = 겨울 (11,12,1월)
```

---

*DONSAGONG 분석 시스템 v2.0*
*체계적 순서 준수 필수*
*2025년 1월 업데이트*